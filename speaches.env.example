# ===================================================================
# Speaches STT/TTS Configuration Example
# ===================================================================
# Copy this file to .env in the same directory and customize values
# Usage: docker-compose -f docker-compose.speaches.yaml --env-file .env up -d

# ===================================================================
# Server Configuration
# ===================================================================
UVICORN_HOST=0.0.0.0
UVICORN_PORT=8000
LOG_LEVEL=info

# ===================================================================
# CORS - Cross-Origin Resource Sharing
# ===================================================================
# Allow frontend and API to access speaches
ALLOW_ORIGINS=["http://localhost:3000","http://localhost:3001","http://192.168.33.4:3000","http://192.168.33.4:3001"]

# ===================================================================
# Model TTL (Time To Live in seconds)
# ===================================================================
# -1 = never unload, 0 = unload immediately, >0 = unload after N seconds
STT_MODEL_TTL=600   # Speech-to-Text (Whisper)
TTS_MODEL_TTL=600   # Text-to-Speech (Piper/Kokoro)
VAD_MODEL_TTL=-1    # Voice Activity Detection (keep loaded)

# ===================================================================
# Whisper (STT) Configuration
# ===================================================================
# Use double underscore __ for nested config
WHISPER__INFERENCE_DEVICE=cuda        # cuda or cpu
WHISPER__COMPUTE_TYPE=float16         # float16, int8, int8_float16
# WHISPER__BEAM_SIZE=5
# WHISPER__BEST_OF=5
# WHISPER__TEMPERATURE=0.0

# ===================================================================
# UI Configuration
# ===================================================================
ENABLE_UI=true  # Gradio web interface at http://localhost:8001

# ===================================================================
# Preload Models (optional)
# ===================================================================
# Download and load models at startup (speeds up first request)
# Format: JSON array of model IDs
PRELOAD_MODELS=["Systran/faster-whisper-large-v3","rhasspy/piper-voices"]

# ===================================================================
# Security (optional)
# ===================================================================
# Uncomment to require API key for all requests
# API_KEY=your-secret-api-key-here

# ===================================================================
# Advanced Configuration
# ===================================================================
# VAD filter (Voice Activity Detection)
_UNSTABLE_VAD_FILTER=true  # Filter out silence/non-speech

# OpenTelemetry (optional - for monitoring)
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
# OTEL_SERVICE_NAME=speaches

# Chat completion integration (for speech-to-speech)
# CHAT_COMPLETION_BASE_URL=http://localhost:11434/v1
# CHAT_COMPLETION_API_KEY=cant-be-empty
